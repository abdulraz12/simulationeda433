Outport:	EQU	$FB
Inport:		EQU	$FC
StateIndex	EQU	$70

		org	$20
		ldsp	#$10
		lda	#$00
		sta	StateIndex
		ldx	#StateVector
Start:		jsr	Delay
		lda	StateIndex
		lda	A,X
		sta	Outport
		jsr	NextState
		bra	Start

Delay:		psha
		pshc
		lda	Inport
Decrease:	deca
		tsta
		bne	Decrease
		pulc
		pula
		rts

NextState:	psha
		pshc
		lda	StateIndex
		inca
		anda	#$03
		sta	StateIndex
		pulc
		pula
		rts

		org	$80
StateVector	FCB	$06,$0A,$09,$05